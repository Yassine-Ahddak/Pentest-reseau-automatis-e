from App.Log import log
from App.Exploit import exploit
from App.Scan import scan
import json
import sys
from App.Interactive import args
class Maps:

    def __init__(self):
        self.main_mapping = []



    def getMap(self):
        log.Logs().Debug("Started : getMap",3)
        #Mapping des arguments avec les fonctions associées

        with open("conf.ini","r",encoding="UTF-8") as c:
            lines = c.readlines()
            for line in lines:
                if line[:1] == "#":
                    continue
                line = line.split("=")
                if "_mapping" in line[0]:
                    line_part_one = line[0].split("_")
                    
                    
                    # Ajout dans un tableau "main"    
                    try:
                        line = line[1].strip()
                        line = json.loads(line)
                        line.insert(0,getattr(sys.modules[__name__], str(line_part_one[0]).lower()))
                        line.insert(1,line_part_one[0])
                        self.main_mapping.append(line)
                    except Exception as e:
                        log.Logs().Debug(e,1)
                        print("Erreur dans le mapping, vérifiez le fichier conf.ini : ",str(e))
                        sys.exit()
       

        log.Logs().Debug("Mapping OK",3)